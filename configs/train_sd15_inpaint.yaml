# ============ SD 1.5 Inpainting ControlNet Config ============
# Fine-tuning pretrained SD 1.5 inpainting ControlNet on custom 3D scene data
# Uses lllyasviel/control_v11p_sd15_inpaint - specifically trained for inpainting!

train:
  epochs: 1000                   # Long training for fine-tuning
  batch_size: 8                  # SD 1.5 is smaller, can use larger batch size
  lr: 0.00001                    # 1e-5 for fine-tuning pretrained (lower than scratch)
  weight_decay: 0.01             # weight decay for AdamW
  use_scheduler: true            # use cosine annealing LR scheduler
  min_lr: 1.0e-7                 # minimum learning rate
  num_workers: 8                 # faster data loading
  save_every: 10                 # save every 10 epochs
  output_dir: /data/group_data/katefgroup/datasets/yjangir/3d_inpaint/checkpoint_sd15_inpaint/
  mixed_precision: fp16          # fp16 is optimal for A6000
  resume_from_checkpoint: auto  # Set to specific checkpoint path to resume training

data:
  root: ./dataset_bridge         # Training dataset
  test_root: ./test_data         # Test dataset (optional)
  image_suffix: _target.png
  cond_suffix: _cond.png
  mask_suffix: _mask.png
  size: 512                      # SD 1.5 optimized for 512x512
  invert_mask: false             # false = 1 is hole, 0 is valid

# Validation Configuration
validation:
  validate_every: 5              # validate every 5 epochs
  num_samples: 4                 # generate 4 validation samples
  num_inference_steps: 20        # fast inference (20 steps)
  guidance_scale: 7.5            # classifier-free guidance scale

model:
  pretrained_model: runwayml/stable-diffusion-v1-5
  scheduler: DDIMScheduler
  cpu_offload: false             # disable since A6000 has ample VRAM
  
  # Pretrained Inpainting ControlNet (SD 1.5)
  # This is THE official inpainting ControlNet - specifically trained for this task!
  # 
  # âœ… lllyasviel/control_v11p_sd15_inpaint  (BEST - pretrained for inpainting)
  # - null                                    (train from scratch, not recommended)
  pretrained_controlnet: lllyasviel/control_v11p_sd15_inpaint

logging:
  print_every: 25                # print loss every N steps
  seed: 42                       # random seed for reproducibility
  wandb_project: sd15-controlnet-inpainting
  wandb_run_name: sd15-inpaint-3dscenes
  wandb_resume: allow

evaluation:  
  num_inference_steps: 50        # high quality inference for final eval
  guidance_scale: 7.5

